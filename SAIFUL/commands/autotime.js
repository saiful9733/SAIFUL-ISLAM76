// autotime.js
// Auto hourly Islamik messages (Bangla date) тАФ compatible with FB-chat-style api (api.sendMessage, api.getThreadList)
//
// ржХржиржлрж┐ржЧрж╛рж░рзЗрж╢ржи:
module.exports.config = {
  name: "autotime",
  version: "1.0.0",
  permission: 0,
  credits: "Jihad",
  description: "ржкрзНрж░рждрж┐ ржШржирзНржЯрж╛рзЯ ржЗрж╕рж▓рж╛ржорж┐ржХ ржмрж╛рж░рзНрждрж╛ ржкрж╛ржарж╛рзЯ (ржмрж╛ржВрж▓рж╛ рждрж╛рж░рж┐ржЦ рж╕рж╣, Asia/Dhaka)",
  prefix: true,
  commandCategory: "user",
  usages: "",
  cooldowns: 5,

  // ржпржжрж┐ рждрзБржорж┐ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржХрзЛржирзЛ ржерзНрж░рзЗржбрзЗ ржкрж╛ржарж╛рждрзЗ ржЪрж╛ржУ, ржПржЦрж╛ржирзЗ ржерзНрж░рзЗржб ржЖржЗржбрж┐ ржпрзЛржЧ ржХрж░рзЛ:
  // ржЙржжрж╛рж╣рж░ржг: sendTo: ["1000123456789"]
  // ржЦрж╛рж▓рж┐ рж░рж╛ржЦрж▓рзЗ ([]) рж╕ржм ржЧрзНрж░рзБржкрзЗ ржкрж╛ржарж╛ржирзЛ рж╣ржмрзЗ (api.getThreadList ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ)ред
  sendTo: [],

  // ржЪрзЗржХ ржЗржирзНржЯрж╛рж░ржнрж╛рж▓ (ржорж┐рж▓рж┐рж╕рзЗржХрзЗржирзНржб) тАФ ржбрж┐ржлрж▓рзНржЯ 60,000 (ржПржХ ржорж┐ржирж┐ржЯрзЗ ржПржХржмрж╛рж░)
  checkInterval: 60 * 1000
};


// ================== messages array ==================
const nazrul = [
  { timer: '12:00:00 AM', message: ['ЁЯТЮ ржмржирзНржзрзБ ржУ ржкрж░рж┐ржмрж╛рж░ржХрзЗ ржнрж╛рж▓рзЛржмрж╛рж╕рзБржи..!\nЁЯлВ ржорж╛ржирзБрж╖рзЗрж░ рж╕рж╛рж╣рж╛ржпрзНржпрзЗ ржПржЧрж┐ржпрж╝рзЗ ржЖрж╕рзБржи..!\nЁЯМИ рж╕ржм ржХрж╛ржЬрзЗ ржирж┐ржпрж╝ржд рж╢рзБржжрзНржз рж░рж╛ржЦрзБржи..!'] },
  { timer: '1:00:00 AM', message: ['ЁЯМЯ ржкрзНрж░рждрж┐ржжрж┐ржи ржирждрзБржи ржХрж┐ржЫрзБ ржнрж╛рж▓рзЛ ржХрж░рзБржи..!\nЁЯХпя╕П рж░рж╛рждрзЗрж░ рждрж╛рж╣рж╛ржЬрзНржЬрзБржж ржЖрж▓рзНрж▓рж╛рж╣рж░ ржХрж╛ржЫрзЗ ржкрзНрж░рж┐ржпрж╝..!\nтШкя╕П рж░ржоржЬрж╛ржирзЗрж░ рж░рзЛржЬрж╛ ржЖржкржирж╛рж░ ржЖрждрзНржорж╛ржХрзЗ рж╢ржХрзНржд ржХрж░ржмрзЗ..!'] },
  { timer: '2:00:00 AM', message: ['ЁЯк╖ ржирж┐ржЬрзЗрж░ ржЪрж░рж┐рждрзНрж░ рж╕рзБржирзНржжрж░ ржХрж░рзБржи, ржЖрж▓рзНрж▓рж╛рж╣ ржЦрзБрж╢рж┐ рж╣ржмрзЗржи..!\nЁЯТО рж╣рж╛рж░рж╛ржо ржерзЗржХрзЗ ржжрзВрж░рзЗ ржерж╛ржХрзБржи, рж╢рж╛ржирзНрждрж┐ ржкрж╛ржмрзЗржи..!\nЁЯЫбя╕П ржИржорж╛ржи рж╣рж▓рзЛ ржЬрзАржмржирзЗрж░ рж╕ржмржЪрзЗржпрж╝рзЗ ржмржбрж╝ рж╕ржорзНржкржж..!'] },
  { timer: '3:00:00 AM', message: ['ЁЯХЛ ржкрзНрж░рждрж┐ржЯрж┐ ржХрж╛ржЬ ржЖрж▓рзНрж▓рж╛рж╣рж░ ржЬржирзНржп ржХрж░рзБржи..!\nтЬи рж╣рж╛рж╕рзБржи, ржнрж╛рж▓рзЛ ржЙржжрзНржжрзАржкржирж╛ ржЫрзЬрж┐рзЯрзЗ ржжрж┐ржи..!\nЁЯУ┐ ржирж╛ржорж╛ржЬ, ржжрзЛржпрж╝рж╛ ржУ ржнрж╛рж▓рзЛ ржХрж╛ржЬтАФржПржЧрзБрж▓рзЛржЗ ржЬрзАржмржирзЗрж░ рж╢ржХрзНрждрж┐..!'] },
  { timer: '4:00:00 AM', message: ['ЁЯФС рждрж╛ржУржмрж╛ ржХрж░рзБржи, ржЧрзБржирж╛рж╣ ржерзЗржХрзЗ ржорзБржХрзНрждрж┐ ржкрж╛ржмрзЗржи..!\nЁЯНГ ржзрзИрж░рзНржп ржзрж░рзБржи, ржЖрж▓рзНрж▓рж╛рж╣ ржХржарж┐ржи рж╕ржоржпрж╝ рж╕рж╣ржЬ ржХрж░ржмрзЗржи..!\nЁЯМИ ржжржпрж╝рж╛ ржУ рж╕рж╣ржорж░рзНржорж┐рждрж╛ ржкрзНрж░ржжрж░рзНрж╢ржи ржХрж░рзБржи, ржЖрж▓рзНрж▓рж╛рж╣ ржЖржкржирж╛ржХрзЗ рж╕рж╛рж╣рж╛ржпрзНржп ржХрж░ржмрзЗржи..!'] },
  { timer: '5:00:00 AM', message: ['ЁЯХМ ржЬрж╛ржорж╛рждрзЗ ржирж╛ржорж╛ржЬтАФржИржорж╛ржирзЗрж░ ржжрзГржврж╝ ржнрж┐рждрзНрждрж┐..!\nЁЯМ╕ ржмрж╛ржмрж╛-ржорж╛ржпрж╝рзЗрж░ ржжрзЛржпрж╝рж╛ ржирж┐ржи, ржЬрзАржмржи рж╣ржмрзЗ ржмрж░ржХрждржкрзВрж░рзНржг..!\nЁЯТб ржирзЗржХ ржХрж╛ржЬ ржХрж░рзБржи, ржЖрж▓рзНрж▓рж╛рж╣рж░ ржжрзГрж╖рзНржЯрж┐ ржЖржкржирж╛рж░ ржЙржкрж░ ржерж╛ржХржмрзЗ..!'] },
  { timer: '6:00:00 AM', message: ['ЁЯХКя╕П ржХрзНрж╖ржорж╛рж╢рзАрж▓ рж╣рзЛржи, ржоржирзЗрж░ рж╢рж╛ржирзНрждрж┐ ржкрж╛ржмрзЗржи..!\nЁЯТЮ рж╕ржжрж╛ржЪрж░ржг ржХрж░рзБржи, ржорж╛ржирзБрж╖ ржЖржкржирж╛рж░ ржкрзНрж░рждрж┐ ржЖржХрзГрж╖рзНржЯ рж╣ржмрзЗ..!'] },
  { timer: '7:00:00 AM', message: ['тЬи ржЖрж▓рзНрж▓рж╛рж╣рж░ ржирж╛ржо рж╕рзНржорж░ржгрзЗ рж╣рзГржжрзЯ рж╢рж╛ржирзНржд рж╣рзЯ..!\nЁЯЩП ржирж┐ржпрж╝ржорж┐ржд ржирж╛ржорж╛ржЬтАФрж╕ржлрж▓ ржЬрзАржмржирзЗрж░ ржЪрж╛ржмрж┐ржХрж╛ржарж┐..!\nЁЯд▓ ржмрзЗрж╢рж┐ ржмрзЗрж╢рж┐ ржжрзЛржпрж╝рж╛ ржХрж░рзБржи, ржЖрж▓рзНрж▓рж╛рж╣ ржирж┐ржХржЯ рж╢рзБржирзБржи..!'] },
  { timer: '8:00:00 AM', message: ['ЁЯк╖ ржЪрж░рж┐рждрзНрж░ржХрзЗ рж╕рзБржирзНржжрж░ ржХрж░рзБржи, ржЖрж▓рзНрж▓рж╛рж╣ ржЦрзБрж╢рж┐ рж╣ржмрзЗржи..!\nЁЯТО рж╣рж╛рж░рж╛ржо ржерзЗржХрзЗ ржжрзВрж░рзЗ ржерж╛ржХрзБржи, рж╢рж╛ржирзНрждрж┐ ржкрж╛ржмрзЗржи..!\nЁЯЫбя╕П ржИржорж╛ржи рж╣рж▓рзЛ ржорж╛ржирзБрж╖рзЗрж░ рж╕ржмржЪрзЗрзЯрзЗ ржмрзЬ рж╕ржорзНржкржж..!'] },
  { timer: '9:00:00 AM', message: ['ЁЯУЦ ржХрзБрж░ржЖржирзЗрж░ рж╢рж┐ржХрзНрж╖рж╛рзЯ ржЬрзАржмржи рж╕рж╛ржЬрж╛ржи..!\nЁЯл╢ ржорж╛ржирзБрж╖ржХрзЗ ржнрж╛рж▓рзЛржмрж╛рж╕рзБржи, ржЖрж▓рзНрж▓рж╛рж╣ ржЦрзБрж╢рж┐ рж╣ржмрзЗржи..!\nЁЯЩП ржжрзЛрзЯрж╛ ржХржЦржирзЛ ржмрж╛ржж ржжрзЗржмрзЗржи ржирж╛..!'] },
  { timer: '10:00:00 AM', message: ['тЬи ржЖрж▓рзНрж▓рж╛рж╣рж░ ржирж┐ржХржЯрзЗ ржмрзЗрж╢рж┐ ржмрзЗрж╢рж┐ ржжрзЛржпрж╝рж╛ ржХрж░рзБржи..!\nЁЯЩП рзл ржУрзЯрж╛ржХрзНржд ржирж╛ржорж╛ржЬ ржирж┐рзЯржорж┐ржд ржкрзЬрзБржи..!\nЁЯдЭ рж╕ржХрж▓рзЗрж░ рж╕рж╛ржерзЗ рж╕ржжрзНржнрж╛ржм ржмржЬрж╛рзЯ рж░рж╛ржЦрзБржи..!'] },
  { timer: '11:00:00 AM', message: ['ЁЯМЩ ржХрзБрж░ржЖржи ржкрзЬрзБржи, ржЖрж▓рзЛрж░ ржкржерзЗ ржЪрж▓рзБржи..!\nЁЯХКя╕П ржХрзНрж╖ржорж╛рж╢рзАрж▓ рж╣рзЛржи, рж╣рзГржжрзЯ рж╢рж╛ржирзНржд рж░рж╛ржЦрзБржи..!\nЁЯТЮ ржнрж╛рж▓рзЛ ржЖржЪрж░ржг ржЫрзЬрж┐рзЯрзЗ ржжрж┐ржи, ржорж╛ржирзБрж╖ ржЖржкржирж╛ржХрзЗ ржоржирзЗ рж░рж╛ржЦржмрзЗ..!'] },
  { timer: '12:00:00 PM', message: ['ЁЯк╖ ржЪрж░рж┐рждрзНрж░ржХрзЗ рж╕рзБржирзНржжрж░ ржХрж░рзБржи, ржЖрж▓рзНрж▓рж╛рж╣ ржЦрзБрж╢рж┐ рж╣ржмрзЗржи..!\nЁЯТО рж╣рж╛рж░рж╛ржо ржерзЗржХрзЗ ржжрзВрж░рзЗ ржерж╛ржХрзБржи, рж╢рж╛ржирзНрждрж┐ ржкрж╛ржмрзЗржи..!\nЁЯЫбя╕П ржИржорж╛ржи рж╣рж▓рзЛ ржЬрзАржмржирзЗрж░ рж╕ржмржЪрзЗрзЯрзЗ ржмрзЬ рж╕ржорзНржкржж..!'] },
  { timer: '1:00:00 PM', message: ['ЁЯМ╕ ржмрж╛ржмрж╛-ржорж╛рзЯрзЗрж░ ржжрзЛржпрж╝рж╛ ржирж┐ржи..!\nЁЯТО рж╣рж╛рж░рж╛ржо ржерзЗржХрзЗ ржирж┐ржЬрзЗржХрзЗ ржмрж╛ржБржЪрж╛ржи..!\nЁЯМИ ржнрж╛рж▓рзЛ ржХрж╛ржЬрзЗ ржПржХрзЗ ржЕржкрж░ржХрзЗ рж╕рж╛рж╣рж╛ржпрзНржп ржХрж░рзБржи..!'] },
  { timer: '2:00:00 PM', message: ['ЁЯХпя╕П рж░рж╛рждрзЗрж░ рждрж╛рж╣рж╛ржЬрзНржЬрзБржж ржЖрж▓рзНрж▓рж╛рж╣рж░ ржирж┐ржХржЯрзЗ ржкрзНрж░рж┐ржпрж╝..!\nтШкя╕П рж░ржоржЬрж╛ржирзЗрж░ рж░рзЛржЬрж╛ рждрж╛ржХржУрзЯрж╛ ржЖржирзЗ..!\nЁЯЫбя╕П ржИржорж╛ржи рж╣рж▓рзЛ рж╕рж░рзНржмрж╢рзНрж░рзЗрж╖рзНржа рж╕ржорзНржкржж..!'] },
  { timer: '3:00:00 PM', message: ['ЁЯМЯ рж░рж╛рждрзЗ ржЙржарзБржи, ржЖрж▓рзНрж▓рж╛рж╣рж░ рж░рж╣ржоржд ржкрж╛ржи..!\nЁЯЫОя╕П ржЧржнрзАрж░ рж░рж╛рждрзЗрж░ рж╕рзЗржХрзЗржирзНржбрзЗ ржЖрж▓рзНрж▓рж╛рж╣рж░ рж╕рзНржорж░ржг ржХрж░рзБржи..!\nЁЯМЩ рждрж╛рж╣рж╛ржЬрзНржЬрзБржж рж╣рж▓рзЛ ржорзБржорж┐ржирзЗрж░ ржЧрж░рзНржм..!'] },
  { timer: '4:00:00 PM', message: ['ЁЯТб ржЬрзНржЮрж╛ржи ржЕрж░рзНржЬржи ржХрж░рзБржи, ржХрж╛рж░ржг ржЬрзНржЮрж╛ржи ржЖрж▓рзНрж▓рж╛рж╣рж░ ржирж┐ржХржЯ ржкрзНрж░рж┐рзЯ..!\nЁЯМ╕ ржЦрж╛рж░рж╛ржк ржЕржнрзНржпрж╛рж╕ ╤ВрзНржпрж╛ржЧ ржХрж░рзБржи, ржнрж╛рж▓рзЛ ржЕржнрзНржпрж╛рж╕ ржЧрзЬрзЗ рждрзБрж▓рзБржи..!\nЁЯХЛ рж╕ржжржХрж╛рж░ ржорж╛ржзрзНржпржорзЗ ржЬрзАржмржиржХрзЗ рж╕рзБржирзНржжрж░ ржХрж░рзБржи..!'] },
  { timer: '5:00:00 PM', message: ['тЬНя╕П ржнрж╛рж▓рзЛ ржХржерж╛ ржмрж▓рж╛ ржЗржмрж╛ржжржд..!\nЁЯдЭ ржнрзНрж░рж╛рждрзГрждрзНржм ржмржЬрж╛рзЯ рж░рж╛ржЦрзБржи..!\nЁЯМЯ ржкрзНрж░рждрж┐ржЯрж┐ ржХрж╛ржЬрзЗ ржирж┐рзЯржд рж╢рзБржжрзНржз рж░рж╛ржЦрзБржи..!'] },
  { timer: '6:00:00 PM', message: ['ЁЯНГ рж╕ржмрж░ ржХрж░рж╛ ржорзБржорж┐ржирзЗрж░ ржЧрзБржг..!\nЁЯТз ржЕржпрзБ ржЖржкржирж╛ржХрзЗ ржЧрзБржирж╛рж╣ ржерзЗржХрзЗ ржжрзВрж░рзЗ рж░рж╛ржЦрзЗ..!\nЁЯк╖ ржирж╛ржорж╛ржЬ ржорзБржорж┐ржирзЗрж░ ржорж┐рж░рж╛ржЬ..!'] },
  { timer: '7:00:00 PM', message: ['ЁЯМ║ рж╕ржирзНрждрзБрж╖рзНржЯрж┐ рж╣рж▓рзЛ ржкрзНрж░ржХрзГржд рж╕ржорзНржкржж..!\nЁЯФС рждрж╛ржУржмрж╛ рж╣рж▓рзЛ ржЬрж╛ржирзНржирж╛рждрзЗрж░ ржжрж░ржЬрж╛рж░ ржЪрж╛ржмрж┐..!\nЁЯк╜ ржПрждрж┐ржорзЗрж░ ржорж╛ржерж╛рзЯ рж╣рж╛ржд ржмрзБрж▓рж╛ржирзЛ рж░рж╣ржоржд ржЖржирзЗ..!'] },
  { timer: '8:00:00 PM', message: ['ЁЯМЯ ржорж╛ржирзБрж╖рзЗрж░ ржЬржирзНржп ржжрзЯрж╛ ржУ рж╕рж╣ржорж░рзНржорж┐рждрж╛ ржкрзНрж░ржжрж░рзНрж╢ржи ржХрж░рзБржи..!\nЁЯд▓ ржмрзЗрж╢рж┐ ржмрзЗрж╢рж┐ ржЖрж▓рзНрж▓рж╛рж╣рж░ ржХрж╛ржЫрзЗ ржжрзЛрзЯрж╛ ржХрж░рзБржи..!\nЁЯТЮ ржмржирзНржзрзБрждрзНржм ржУ ржнрж╛рж▓ржмрж╛рж╕рж╛ рж╣рж╛рж▓рж╛рж▓ ржкржерзЗ рж░ржХрзНрж╖рж╛ ржХрж░рзБржи..!'] },
  { timer: '9:00:00 PM', message: ['ЁЯХКя╕П ржкрж╛ржк ржерзЗржХрзЗ ржжрзВрж░рзЗ ржерж╛ржХрзБржи..!\nЁЯМЩ ржЖрж▓рзНрж▓рж╛рж╣рж░ рж░рж╣ржорждрзЗ ржкрзНрж░рждрж┐ржжрж┐ржи ржирждрзБржи рж╢рзБрж░рзБ ржХрж░рзБржи..!\nтЬи ржкрзНрж░рждрж┐ржЯрж┐ ржХрж╛ржЬрзЗрж░ рж╢рзБрж░рзБрж░ ржЖржЧрзЗ ржЖрж▓рзНрж▓рж╛рж╣рж░ ржирж╛ржо рж╕рзНржорж░ржг ржХрж░рзБржи..!'] },
  { timer: '10:00:00 PM', message: ['ЁЯХЛ ржЖрж▓рзНрж▓рж╛рж╣рж░ ржкржерзЗ ржЬрзАржмржирзЗрж░ ржкрзНрж░рждрж┐ржЯрж┐ ржкржжржХрзНрж╖рзЗржк рж░рж╛ржЦрзБржи..!\nЁЯУ┐ рж╕ржХрж╛рж▓-рж╕ржирзНржзрзНржпрж╛рж░ ржжрзЛрзЯрж╛ ржкрзЬрзБржи..!\nЁЯМ╣ ржЕржирзНржпрзЗрж░ ржкрзНрж░рждрж┐ рж╕ржжрж╛ржЪрж░ржг ржХрж░рзБржи..!'] },
  { timer: '11:00:00 PM', message: ['ЁЯТЮ рж░рж╛рждрзЗрж░ ржЗржмрж╛ржжржд ржоржирзЗрж░ ржирзИржГрж╢ржмрзНржжрзНржп ржмрж╛рзЬрж╛рзЯ..!\nЁЯФС ржЧрзЛржкржи ржжрзЛрзЯрж╛ ржЖрж▓рзНрж▓рж╛рж╣рж░ ржХрж╛ржЫрзЗ ржкрзНрж░рж┐ржпрж╝..!\nЁЯХКя╕П рж░рж╛рждрзЗрж░ ржирж╛ржорж╛ржЬ ржкрж╛ржк ржорзБржЫрзЗ ржжрзЗрзЯ..!'] }
];
// =====================================================


// onLoad: ржЪрзЗржХ ржЪрж╛рж▓рж╛ржирзЛ рж╢рзБрж░рзБ ржХрж░ржмрзЗ
module.exports.onLoad = function ({ api }) {
  console.log("[autotime] loaded - checking every", module.exports.config.checkInterval, "ms (Asia/Dhaka)");
  let lastSentKey = null; // duplicate рж░рзЛржзрзЗ ржмрзНржпржмрж╣рж╛рж░

  setInterval(() => {
    try {
      const now = new Date();

      // current hour:minute in Asia/Dhaka (ржЙржжрж╛рж╣рж░ржг: "1:00 AM")
      const nowHM = new Intl.DateTimeFormat('en-US', {
        timeZone: 'Asia/Dhaka',
        hour12: true,
        hour: 'numeric',
        minute: '2-digit'
      }).format(now);

      // normalize scheduled timer by removing seconds -> "1:00:00 AM" => "1:00 AM"
      const nazruld = nazrul.find(item => item.timer.replace(/:\d{2}/, '') === nowHM);
      if (!nazruld) return;

      // ржмрж╛ржВрж▓рж╛ рждрж╛рж░рж┐ржЦ/ржорж╛рж╕/ржмржЫрж░/ржжрж┐ржи
      const bnDay = new Intl.DateTimeFormat('bn-BD', { timeZone: 'Asia/Dhaka', day: 'numeric' }).format(now);
      const bnMonth = new Intl.DateTimeFormat('bn-BD', { timeZone: 'Asia/Dhaka', month: 'long' }).format(now);
      const bnYear = new Intl.DateTimeFormat('bn-BD', { timeZone: 'Asia/Dhaka', year: 'numeric' }).format(now);
      const bnWeekday = new Intl.DateTimeFormat('bn-BD', { timeZone: 'Asia/Dhaka', weekday: 'long' }).format(now);

      const dhakaTime = new Intl.DateTimeFormat('en-US', {
        timeZone: 'Asia/Dhaka',
        hour12: true,
        hour: 'numeric',
        minute: '2-digit'
      }).format(now);

      const key = `${nowHM}_${bnDay}_${bnMonth}_${bnYear}`;
      if (lastSentKey === key) return; // ржПржХржЗ ржорж┐ржирж┐ржЯрзЗ рж░рж┐-рж╕рзЗржирзНржб ржмржирзНржз
      lastSentKey = key;

      const islamicChat =
`тХФтХРтЭЦтХРтЭЦтХРтЭЦтХРтЭЦтХРтЭЦтХРтЭЦтХРтХЧ  
  тП░ ЁЭЧзЁЭЧЬЁЭЧаЁЭЧШ & ЁЭЧЧЁЭЧФЁЭЧзЁЭЧШ тП░   
 тХЪтХРтЭЦтХРтЭЦтХРтЭЦтХРтЭЦтХРтЭЦтХРтЭЦтХРтХЭ
     тХФтХРтЬктХРЁЯХТтХРтЬктХРтХЧ
     ЁЭРУЁЭРвЁЭРжЁЭРЮ: ${dhakaTime}
     тХЪтХРтХРтХРтХРтХРтХРтХРтХРтХЭ
ЁЯУЕ ЁЭРГЁЭРЪЁЭРнЁЭРЮ: ${bnDay}
ЁЯУЫ ЁЭРГЁЭРЪЁЭР▓: ${bnWeekday}
ЁЯЧУя╕П ЁЭРМЁЭРиЁЭРзЁЭРнЁЭРб: ${bnMonth}
ЁЯУЖ ЁЭРШЁЭРЮЁЭРЪЁЭРл: ${bnYear}
тФБтФБтФБтФБтФБтФБтФБтФБтФБтФБтФБтФБтФБтФБтФБ
`;

      const finalMessage = islamicChat + '\n' + (Array.isArray(nazruld.message) ? nazruld.message.join('\n') : nazruld.message);

      // ржпржжрж┐ config.sendTo-ржП ржерзНрж░рзЗржб ржЖржЗржбрж┐ ржжрзЗрзЯрж╛ ржерж╛ржХрзЗ, рж╕рзЗржЧрзБрж▓рзЛрждрзЗ ржкрж╛ржарж╛ржУ, ржирж╛рж╣рж▓рзЗ рж╕ржм ржЧрзНрж░рзБржкрзЗ ржкрж╛ржарж╛ржУ
      if (Array.isArray(module.exports.config.sendTo) && module.exports.config.sendTo.length > 0) {
        module.exports.config.sendTo.forEach(tid => {
          api.sendMessage(finalMessage, tid, (err) => {
            if (err) console.error("[autotime] send error to", tid, err);
          });
        });
      } else {
        // send to all group threads (api.getThreadList used commonly in fb-chat bot frameworks)
        try {
          api.getThreadList(100, null, ['INBOX'], (err, list) => {
            if (err) return console.error("[autotime] getThreadList error:", err);
            list.forEach(thread => {
              if (thread.isGroup || thread.is_group) {
                api.sendMessage(finalMessage, thread.threadID || thread.id, (e) => {
                  if (e) console.error("[autotime] send error", e);
                });
              }
            });
          });
        } catch (e) {
          // ржХрж┐ржЫрзБ bot-framework ржП getThreadList signature ржЖрж▓рж╛ржжрж╛ рж╣рж▓рзЗ ржПржЦрж╛ржирзЗ ржХрж╛рж╕рзНржЯржо рж▓ржЬрж┐ржХ рж▓рж╛ржЧрждрзЗ ржкрж╛рж░рзЗ
          console.error("[autotime] error while trying to broadcast to groups:", e);
        }
      }

    } catch (error) {
      console.error("[autotime] interval error:", error);
    }
  }, module.exports.config.checkInterval || 60 * 1000);
};


// run(command) тАФ рж╣рж╛рждрзЗ ржХрж▓ржорзЗ ржкрж╛ржарж╛рждрзЗ ржЪрж╛ржЗрж▓рзЗ: .autotime (ржЖрж░ рждрзЛржорж╛рж░ ржлрзНрж░рзЗржоржУрзЯрж╛рж░рзНржХ ржЕржирзБржпрж╛ржпрж╝рзА run signature ржмржжрж▓рж╛рждрзЗ рж╣ржмрзЗ)
module.exports.run = async function ({ api, event }) {
  try {
    const now = new Date();
    const dhakaTime = new Intl.DateTimeFormat('en-US', { timeZone: 'Asia/Dhaka', hour12: true, hour: 'numeric', minute: '2-digit' }).format(now);
    const bnDay = new Intl.DateTimeFormat('bn-BD', { timeZone: 'Asia/Dhaka', day: 'numeric' }).format(now);
    const bnMonth = new Intl.DateTimeFormat('bn-BD', { timeZone: 'Asia/Dhaka', month: 'long' }).format(now);
    const bnYear = new Intl.DateTimeFormat('bn-BD', { timeZone: 'Asia/Dhaka', year: 'numeric' }).format(now);
    const bnWeekday = new Intl.DateTimeFormat('bn-BD', { timeZone: 'Asia/Dhaka', weekday: 'long' }).format(now);

    const header = `тХФтХРтЭЦтХР ЁЭЧзЁЭЧШЁЭЧжЁЭЧз ЁЭЧаЁЭЧШЁЭЧжЁЭЧжЁЭЧФЁЭЧЪЁЭЧШ тХРтЭЦтХРтХЧ\nTime: ${dhakaTime}\nDate: ${bnDay} ${bnMonth} ${bnYear} (${bnWeekday})\nтФБтФБтФБтФБтФБтФБтФБтФБтФБтФБтФБтФБтФБтФБтФБ\n`;
    const sample = nazrul[0].message.join('\n');
    api.sendMessage(
      header + sample + '\n\nЁЯССЁЭРБЁЭРиЁЭРн ЁЭРОЁЭР░ЁЭРзЁЭРЮЁЭРл тЮа ЁЭРТЁЭРАЁЭРИЁЭРЕЁЭРФЁЭРЛ ЁЭРИЁЭРТЁЭРЛЁЭРАЁЭРМ\nЁЯМЯЁЭРВЁЭРлЁЭРЮЁЭРЪЁЭРнЁЭЧ╝ЁЭРл тФБ ЁЭРТЁЭРЪЁЭРвЁЭРЯЁЭРоЁЭРе ЁЭРИЁЭРмЁЭРеЁЭРЪЁЭРж ЁЯМЯ',
      event.threadID
    );  } catch (e) {
    console.error(e);
  }
};
